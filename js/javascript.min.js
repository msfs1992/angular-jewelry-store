var currentImgWidth,currentImgHeight,searchFlag,mWidth,calc,pheight,decimal,mRows,itemsperrow,mtop,mTop,rowCounter,itemPosition,cantidadProductos,rows,routeApp=angular.module("routeApp",["ngRoute"]),temp='<div id="rank" resize notifier="notifyServiceOnChage(params)" class="clearfix" style="height:{{ mheight }}px;"><a ng-repeat="product in products | multipleWords:searchString" ng-href="{{ ptype }}/{{ product.id }}" class="rankimage" ng-style="resizeWithOffset(0)" style="width:{{ width }}px;left:{{  left($index) }}px;top:{{ top($index) }}px;" data-id="{{ product.id }}" data-type="{{ ptype }}"><div class="rankimgHolder"><img class="mainpic" ng-src="products/{{ ptype }}/{{ product.id }}/{{ product.id }}.jpg" /></div><div class="rank-info"><div class="price">$ {{ product.price }}</div><div class="relative verticalCenter"><div class="rankname clearfix">{{ product.titulo }}</div><div class="descripcion">{{ product.descripcion }}</div></div></div></a></div>';function queryUserController(l,e,r,t,n){n.getRequest("products/"+r.current.$$route.paramType+"/"+t.product+"/"+t.product+".json").then(function(e,t){window.scrollTo(0,0),document.getElementById("searchHolder").style.display="none",l.userInfo=e.data,n.setMeta(l.userInfo.descripcion,l.userInfo.titulo),l.ptype=r.current.$$route.paramType,l.cover={background:"url(products/"+l.ptype+"/"+l.userInfo.id+"/"+l.userInfo.id+".jpg)","background-size":"cover"},l.calcWidth=function(e,t,r){return 100*r/t*e/100},l.aspectRatio=function(e,t){return e/t*100},l.goBig=function(e,t){var r,n=document.getElementById("bigGallery"),i=document.getElementById("imgGal"),o=document.getElementById("imgFrame");i.onload=function(){currentImgWidth=this.naturalWidth,currentImgHeight=this.naturalHeight,r=l.calcWidth(this.naturalWidth,this.naturalHeight,window.innerHeight),this.naturalWidth>window.innerWidth?(o.style.width="100%",i.style.width="100%",i.clientHeight>window.innerHeight-42?(o.style.width=r+"px",i.style.height="100%",o.style.height=window.innerHeight+"px"):(i.style.height="100%",o.style.height="auto")):this.naturalHeight>window.innerHeight-42?(o.style.width=r+"px",i.style.width="100%",i.style.height="100%",o.style.height=window.innerHeight+"px"):(o.style.width=this.naturalWidth+"px",i.style.width=this.naturalWidth+"px",i.style.height=this.naturalHeight+"px",o.style.height=this.naturalHeight+"px")},i.setAttribute("src","products/"+l.ptype+"/"+t+"/fotos/"+e),document.documentElement.style.overflowY="hidden",n.style.display="block"}})}function menu(t){t.closed=!0,t.clickMenu=function(e){t.closed?(e.classList.add("moveMenu"),e.children[0].classList.add("animateLine1"),e.children[2].classList.add("animateLine3"),document.getElementById("responsiveMenu").style.right="0px",t.closed=!1):(e.style.left="-46px",e.classList.add("moveMenuReverse"),e.children[0].classList.add("animateLine1Reverse"),e.children[2].classList.add("animateLine3Reverse"),e.children[0].classList.remove("animateLine1"),e.children[2].classList.remove("animateLine3"),document.getElementById("responsiveMenu").style.right="-250px",t.closed=!0)}}function queryListController(n,i,o,l,s){s.setMeta("Joyas, Anillos, Brazaletes, Collares, Caravanas, Pendientes, Estilo Gotico, Estilo Dark.","Jewelry"),n.anillos="anillos",n.pendientes="pendientes",n.collares="collares",n.brazaletes="brazaletes",document.getElementById("searchHolder").style.display="block",n.notifyServiceOnChage=function(){console.log("Launched")},null!=o.product||s.getRequest("products/"+i.current.$$route.paramType+".json").then(function(e,t){if(n.ptype=i.current.$$route.paramType,null!=o.region){var r=o.region;r=r.split("-").join(" "),n.products=l("filter")(e.data,{region:r})}else n.products=e.data;cantidadProductos=n.products.length,mRows=Math.ceil(n.products.length/itemsperrow),n.width=s.width(),n.mheight=s.height(mRows),n.top=s.top,n.left=s.left,s.doResize(document.body.clientWidth)})}routeApp.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{template:temp,controller:"queryListController",paramType:"anillos"}).when("/anillos",{template:temp,controller:"queryListController",paramType:"anillos"}).when("/anillos/:product",{templateUrl:"../userTemplate.html",controller:"queryUserController",paramType:"anillos"}).when("/collares",{template:temp,controller:"queryListController",paramType:"collares"}).when("/collares/:product",{templateUrl:"../userTemplate.html",controller:"queryUserController",paramType:"collares"}).when("/pendientes",{template:temp,controller:"queryListController",paramType:"pendientes"}).when("/pendientes/:product",{templateUrl:"../userTemplate.html",controller:"queryUserController",paramType:"pendientes"}).when("/brazaletes",{template:temp,controller:"queryListController",paramType:"brazaletes"}).when("/brazaletes/:product",{templateUrl:"../userTemplate.html",controller:"queryUserController",paramType:"brazaletes"}).otherwise({redirectTo:"/"}),window.history&&window.history.pushState&&t.html5Mode({enabled:!0,requireBase:!1})}]),searchFlag=!(itemsperrow=5),itemPosition=rowCounter=1,routeApp.filter("multipleWords",["$filter","customFunctions",function(e,d){function t(e,t){if(null==t||0==t.length)return e;for(var r=[],n=t.toLowerCase().split(" "),i=0;i<e.length;i++)for(var o=0,l=0;l<n.length&&1!=o;l++){if(-1!==e[i].titulo.toLowerCase().indexOf(n[l])){r.push(e[i]),o=1;break}if(-1!==e[i].descripcion.toLowerCase().indexOf(n[l])){r.push(e[i]),o=1;break}for(k in e[i].tags)if(-1!==e[i].tags[k].toLowerCase().indexOf(n[l])){r.push(e[i]),o=1;break}}rows=Math.ceil(r.length/itemsperrow);var s=document.getElementById("rank"),a=document.getElementById("results");return s.style.height=d.height(rows)+"px",0==r.length?(a.innerHTML="No se encontraron resultados",a.style.display="block"):(a.innerHTML="",a.style.display="none"),r}return t.$stateful=!0,t}]),routeApp.controller("queryListController",["$scope","$route","$routeParams","$filter","customFunctions",queryListController]),routeApp.controller("queryUserController",["$scope","$http","$route","$routeParams","customFunctions",queryUserController]),routeApp.controller("menu",["$scope",menu]),routeApp.directive("resize",["$window","customFunctions",function(i,o){return function(n,e,t){var r=angular.element(i);n.$watch(function(){return{h:document.body.clientHeight,w:document.body.clientWidth}},function(e,t){if(e.w!=t.w){if("block"==document.getElementById("bigGallery").style.display)return void o.resizeGallery(e.w);console.log("nogallewry"),o.doResize(e.w)}mRows=Math.ceil(cantidadProductos/itemsperrow);var r=1/itemsperrow;decimal=null==r.toString().split(".")[1]?NaN:r.toString().split(".")[1].charAt(0),n.width=o.width(),n.mheight=o.height(mRows),n.outLeft=o.left(n.$index),n.outTop=o.top(n.$index)},!0),r.on("resize",function(){n.$apply()})}}]),routeApp.factory("customFunctions",["$http",function(t){return{resizeGallery:function(e){document.getElementById("bigGallery");var t,r,n,i=document.getElementById("imgGal"),o=document.getElementById("imgFrame");r=i.clientWidth,n=i.clientHeight,t=100*window.innerHeight/n*r/100,i.clientWidth>window.innerWidth+20?(o.style.width="100%",i.style.width="100%",i.clientHeight>window.innerHeight-42?(o.style.width=t+"px",i.style.height="100%",o.style.height=window.innerHeight+"px"):(i.style.height="100%",o.style.height="auto")):i.clientHeight>window.innerHeight-42?(o.style.width=t+"px",i.style.width="100%",i.style.height="100%",o.style.height=window.innerHeight+"px"):(o.style.width=o.style.width+"px",i.style.width=o.style.width+"px",i.style.height=o.style.height+"px",o.style.height=o.style.height+"px")},getRequest:function(e){return t.get(e)},doResize:function(e){e<1050&&(itemsperrow=4,document.getElementById("searchHolder").style.width="calc(100% - 238px)"),e<700&&(itemsperrow=3,document.getElementById("search").classList.remove("searchToggle")),e<500&&(itemsperrow=2),1050<e&&(itemsperrow=5,document.getElementById("searchHolder").style.width="calc(100% - 750px)"),600<e&&(document.querySelector(".webname").style.display="block",document.getElementById("searchHolder").classList.remove("searchHolderToggle"),document.querySelector(".searchHolder").classList.remove("searchHToggle")),e<360&&(itemsperrow=1)},left:function(e){var t=(e+1)/itemsperrow,r=null==t.toString().split(".")[1]?NaN:t.toString().split(".")[1].charAt(0);return r==decimal?this.res=0:isNaN(r)?this.res=1==itemsperrow?0:mWidth*(itemsperrow-1):5==itemsperrow||2==itemsperrow?this.res=mWidth*(r/2-1):3!=itemsperrow&&4!=itemsperrow||(this.res=mWidth*Math.ceil(r/2-2)),this.res},top:function(e){return mtop=Math.ceil((e+1)/itemsperrow),pheight*(mtop-=1)},width:function(){return mWidth=document.body.clientWidth/itemsperrow},height:function(e){return e*(pheight=mWidth)},setMeta:function(e,t){document.getElementById("metaDescripcion").setAttribute("content",e),document.getElementById("metaTitle").setAttribute("content",t),document.getElementById("title").innerHTML=t}}}]);var lines=document.querySelectorAll(".line"),line1=lines[0],line2=lines[2],menu=document.getElementById("menu"),searchHolder=document.getElementById("searchHolder"),logo=document.querySelector(".webname");function closeImage(){document.getElementById("bigGallery").style.display="none",document.documentElement.style.overflowY="scroll"}searchHolder.addEventListener("transitionend",function(e){"right"==e.propertyName&&0==searchFlag&&(logo.style.display="block")}),line1.addEventListener("animationend",function(e){"mymoveoneReverse"==e.animationName&&(line1.classList.remove("animateLine1Reverse"),line1.classList.remove("animateLine1"),line2.classList.remove("animateLine3Reverse"),line2.classList.remove("animateLine3"),menu.classList.remove("moveMenu"),menu.classList.remove("moveMenuReverse"))},!0),document.querySelector(".flaticon-magnifier").onclick=function(){window.innerWidth<=600&&(searchFlag?(searchFlag=!1,document.getElementById("search").classList.remove("searchToggle"),document.querySelector(".searchHolder").classList.remove("searchHToggle"),document.getElementById("searchHolder").classList.remove("searchHolderToggle")):(searchFlag=!0,document.querySelector(".webname").style.display="none",document.getElementById("search").classList.add("searchToggle"),document.getElementById("searchHolder").classList.add("searchHolderToggle"),document.querySelector(".searchHolder").classList.add("searchHToggle")))},document.addEventListener("DOMContentLoaded",function(e){document.body.removeChild(document.body.childNodes[document.body.childNodes.length-2])}),window.onbeforeunload=function(){window.scrollTo(0,0)};